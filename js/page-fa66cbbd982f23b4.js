(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{43053:function(e,s,a){Promise.resolve().then(a.bind(a,55156))},55156:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return eJ}});var t,n,r=a(57437),i=a(40110),l=a(22020),o=a(67966);let c=(0,l.Ue)()((0,o.n)(e=>({wallets:{},delAllWallets:()=>e(e=>{e.wallets={}}),delWallet:s=>e(e=>{delete e.wallets[s]}),addWallet:s=>e(e=>{e.wallets[s.address]=s}),setSolBalance:(s,a)=>e(e=>{e.wallets[s].solBalance=a}),addToken:(s,a,t)=>e(e=>{e.wallets[s].tokens[a]=t}),setTokenBalance:(s,a,t)=>e(e=>{e.wallets[s].tokens[a].balance=t})}))),d=(0,l.Ue)()((0,o.n)(e=>({wallets:{},delAllWallets:()=>e(e=>{e.wallets={}}),delWallet:s=>e(e=>{delete e.wallets[s]}),addWallet:s=>e(e=>{e.wallets[s.address]=s}),setSolBalance:(s,a)=>e(e=>{e.wallets[s].solBalance=a}),addToken:(s,a,t)=>e(e=>{e.wallets[s].tokens[a]=t}),setTokenBalance:(s,a,t)=>e(e=>{e.wallets[s].tokens[a].balance=t})})));var m=a(37355),u=a(2265),g=a(85754),p=a(42706),h=a(23444),x=a(98430),f=a.n(x);let v={FEE_WALLET:"Gj327cqif5FiSN2peeqZ7Tvfy936bxwWKnQVJ74fHjan",rpc:"https://mainnet.helius-rpc.com/?api-key=b9d88906-ac34-4592-b02d-a8fa09739b4f",heliseRpc:"https://mainnet.helius-rpc.com/?api-key=b9d88906-ac34-4592-b02d-a8fa09739b4f",useRaydiumFee:.0001,usePumpFee:.0005,jitoTipAccount:"HFqU5x63VTqvQss8hp11i4wVV8bD44PvwucfZ2bU7gRe",jitoApi:["https://mainnet.block-engine.jito.wtf","https://amsterdam.mainnet.block-engine.jito.wtf","https://frankfurt.mainnet.block-engine.jito.wtf","https://ny.mainnet.block-engine.jito.wtf","https://tokyo.mainnet.block-engine.jito.wtf"]},y=[{account:"",balance:0,address:"So11111111111111111111111111111111111111112",decimals:9,name:"Wrapped SOL",symbol:"SOL",logoURI:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},{account:"",balance:0,address:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",decimals:6,name:"USD Coin",symbol:"USDC",logoURI:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png"},{account:"",balance:0,address:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",decimals:6,name:"USDT",symbol:"USDT",logoURI:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB/logo.svg"}],b=[{account:"",address:"ASM5dsjwjZZWTY2E9H569MKCzK2aTaEsSpi6AfKoESp6",balance:0,decimals:9,name:"DogeDesigner",symbol:"DogeD",logoURI:"https://arweave.net/xQkqqJjhsnegZcjq-a-TXLk10DfBd-yxLdp6RSENwZk"},{account:"",balance:0,address:"85VBFQZC9TZkfaptBWjvUw7YbZjy52A6mjtPGjstQAmQ",decimals:6,name:"Wormhole Token",symbol:"W",logoURI:"https://wormhole.com/token.png"}],w=[{account:"",balance:0,address:"So11111111111111111111111111111111111111112",decimals:9,name:"Wrapped SOL",symbol:"SOL",logoURI:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"}],j=[{account:"",address:"8BPSf3ipjgMbJ7Jd3GYxAzJjA7TJxmcHg1ii276h5R1W",balance:0,decimals:6,name:"China Mens Football",symbol:"CHN",logoURI:"https://cf-ipfs.com/ipfs/QmbjfwERTBEqrDgmHimFdFftrGDfR9CPDeaEc3rssy3fCW"}],k=(0,l.Ue)()((0,o.n)(e=>({conn:new m.Connection(v.rpc,"confirmed"),setRpc:s=>e(e=>{e.conn=new m.Connection(s,"confirmed")})}))),N=(0,l.Ue)()((0,o.n)(e=>({baseToken:{account:"",balance:0,address:"So11111111111111111111111111111111111111112",decimals:9,name:"Wrapped SOL",symbol:"SOL",logoURI:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},quoteToken:{balance:0,account:"",address:"8BPSf3ipjgMbJ7Jd3GYxAzJjA7TJxmcHg1ii276h5R1W",decimals:6,name:"China Mens Football",symbol:"CHN",logoURI:"https://cf-ipfs.com/ipfs/QmbjfwERTBEqrDgmHimFdFftrGDfR9CPDeaEc3rssy3fCW"},setBaseToken:s=>e(e=>{e.baseToken=s}),setQuoteToken:s=>e(e=>{e.quoteToken=s})}))),S=(0,l.Ue)()((0,o.n)(e=>({baseToken:{account:"",balance:0,address:"So11111111111111111111111111111111111111112",decimals:9,name:"Wrapped SOL",symbol:"SOL",logoURI:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},quoteToken:{balance:0,account:"",address:"ASM5dsjwjZZWTY2E9H569MKCzK2aTaEsSpi6AfKoESp6",decimals:9,name:"DogeDesigner",symbol:"DogeD",logoURI:"https://arweave.net/xQkqqJjhsnegZcjq-a-TXLk10DfBd-yxLdp6RSENwZk"},setBaseToken:s=>e(e=>{e.baseToken=s}),setQuoteToken:s=>e(e=>{e.quoteToken=s})})));var T=a(17048);let R=(0,l.Ue)()((0,o.n)(e=>({logs:[],addLog:(s,a,t,n)=>e(e=>{let r={logTime:(0,T.Li)(),logType:s,message:a,tx:null!=n?n:"",address:null!=t?t:""};e.logs.unshift(r)}),clearLog:()=>e(e=>{e.logs=[]})})));function P(){let[e,s]=(0,u.useState)("2T7wBXqKT6WTL5amE45z859pm5QoftufV1ShpEYP1Dn1HivimxotLbi6vpSemWkKKYiBzCCLPEyoyyc8Vmq7Vk2"),{wallets:a,addWallet:t,delAllWallets:n}=d(),{conn:i}=k(),{addLog:l}=R(),{baseToken:o,quoteToken:c}=N(),[f,v]=(0,u.useState)(!1),y=async()=>{v(!0);let s=e.split("\n");for(let e=0;e<s.length;e++)try{let a=m.Keypair.fromSecretKey(x.decode(s[e].trim())),n=await i.getBalance(a.publicKey),r={},l=0,d=0;"So11111111111111111111111111111111111111112"==o.address&&(l=n),"So11111111111111111111111111111111111111112"==c.address&&(d=n),r[o.address]={account:"",balance:l,mint:o.address,address:o.address,name:o.name,decimals:o.decimals,symbol:o.symbol,logoURI:o.logoURI},r[c.address]={account:"",balance:d,mint:c.address,address:c.address,name:c.name,decimals:c.decimals,symbol:c.symbol,logoURI:c.logoURI},t({address:a.publicKey.toBase58(),solBalance:n,keypair:a,tokens:r})}catch(s){s.message.includes("403")?l("error","rpc请求失败，请检查网络连接。或者更换rpc节点"):l("error","第".concat(e+1,"行私钥有误，已忽略该行"))}v(!1)};return(0,r.jsxs)(p.Vq,{children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsx)(g.z,{variant:"outline",loading:f,children:"导入钱包"})}),(0,r.jsxs)(p.cZ,{className:"md:max-w-[700px] ",children:[(0,r.jsxs)(p.fK,{children:[(0,r.jsx)(p.$N,{className:" text-center",children:"导入钱包"}),(0,r.jsx)(p.Be,{className:" text-sm text-center",children:"(私钥一行一个)"})]}),(0,r.jsx)("div",{className:"grid w-full h-full",children:(0,r.jsx)(h.g,{className:"h-full min-h-[400px] text-[0.7rem] text-red-400",value:e,onChange:e=>{s(e.target.value)},placeholder:"填入私钥一行一个",id:"message"})}),(0,r.jsx)(p.cN,{className:"mr-2",children:(0,r.jsx)(p.GG,{asChild:!0,children:(0,r.jsx)(g.z,{variant:"default",onClick:y,type:"submit",children:"导入"})})})]})]})}var B=a(45179),C=a(18025),I=a(53879);let E=(0,l.Ue)()((0,o.n)(e=>({swapSetting:{slippage:5,amountType:"fixed",amountMin:.01,amountMax:.02,timeMin:2,timeMax:4,swapType:"pumping",targetPrice:.01,fee:1e-6,poolType:"openbook"},taskCount:0,nowPrice:0,setSwapSetting:s=>e(e=>{e.swapSetting={...e.swapSetting,...s}}),incrementTaskCount:()=>e(e=>{e.taskCount+=1}),clearTaskCount:()=>e(e=>{e.taskCount=0}),setNowPrice:s=>e(e=>{e.nowPrice=s})})));var K=a(93671);function A(){let{swapSetting:e}=E(),{baseToken:s,quoteToken:a,setBaseToken:t,setQuoteToken:n}=N(),[i,l]=(0,u.useState)({}),[o,c]=(0,u.useState)(""),[d,g]=(0,u.useState)(""),[h,x]=(0,u.useState)(j),{conn:f}=k(),y=e=>{let s=e.currentTarget.getAttribute("value");h.map(e=>{e.address===s&&n(e)})},b=e=>{let s=e.currentTarget.getAttribute("value");w.map(e=>e.address===s&&t(e))},S=async e=>{let s=e.target.value;if(l({}),c(s),g(""),""==s)return;let a=h.find(e=>e.address===s);if(a){l(a);return}if(null==await (0,K.f)(s,f)){g("代币不是PUMP代币");return}g("查询中。。。");try{let e=new m.PublicKey(s),a=await fetch(v.heliseRpc,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"text",method:"getAsset",params:{id:e.toBase58()}})}),t=await a.json(),n="未知",r="未知",i="/image/unknow.svg",o=0;t.result.content&&(n=t.result.content.metadata.name,r=t.result.content.metadata.symbol,i=t.result.content.links.image),o=t.result.token_info.decimals;let c={account:"",balance:0,address:e.toBase58(),decimals:o,name:n,symbol:r,logoURI:i};x([...h,c]),g(""),l(c)}catch(e){g("找不到代币")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2  mt-4",children:[(0,r.jsxs)("span",{className:"ml-3 text-gray-600 font-bold",children:["基础代币",(0,r.jsx)("span",{className:" text-sm font-light",children:"（价值币）"})]}),(0,r.jsxs)("span",{className:"ml-10 text-gray-600 font-bold",children:["目标代币",(0,r.jsx)("span",{className:" text-sm font-light",children:"（PUMP币）"})]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)(p.Vq,{children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsxs)("div",{className:" hover:cursor-pointer m-2 w-[45%] h-[3.5rem] border border-solid rounded-xl text-gray-500 grid grid-cols-5 items-center ",children:[(0,r.jsx)("picture",{className:" ml-4 block col-span-1 w-[70%]",children:(0,r.jsx)("img",{className:"rounded-full",src:s.logoURI,alt:"imges"})}),(0,r.jsxs)("div",{className:" ml-3 col-span-4 grid grid-cols-1 text-left w-full",children:[(0,r.jsx)("span",{className:" text-sm",children:s.symbol}),(0,r.jsx)("span",{className:" text-sm",children:(0,T.D2)(s.address)})]})]})}),(0,r.jsxs)(p.cZ,{className:"md:max-w-[560px]  ",children:[(0,r.jsx)(p.fK,{children:(0,r.jsx)(p.$N,{className:" text-center",children:"选择基础代币"})}),(0,r.jsx)("div",{className:"grid w-full h-full",children:(0,r.jsx)("ul",{className:"mt-2",children:w.map((e,s)=>(0,r.jsx)("li",{className:" rounded-md p-2 m-1 grid  hover:bg-green-200",value:e.address,onClick:b,children:(0,r.jsxs)(p.GG,{className:"grid w-full grid-cols-5",children:[(0,r.jsxs)("picture",{className:" flex ml-2 col-span-2",children:[(0,r.jsx)("img",{className:"rounded-full w-[35px] h-[35px]",src:e.logoURI,alt:"imges"}),(0,r.jsxs)("div",{className:"grid ml-3",children:[(0,r.jsx)("span",{className:"text-sm  text-left text-gray-500",children:e.symbol}),(0,r.jsx)("span",{className:"text-sm text-left text-gray-500",children:e.name})]})]}),(0,r.jsx)("div",{className:"grid h-full items-center col-span-3",children:(0,r.jsx)("span",{className:" block text-gray-400  text-right mr-5",children:(0,T.D2)(e.address)})})]})},s))})})]})]}),(0,r.jsx)("div",{className:" items-center m-3 mt-[0.8rem] p-1 w-[2.5rem] h-[2.5rem] hover:cursor-pointer hover:bg-green-100 rounded-full ",children:"pumping"==e.swapType?(0,r.jsx)(C.Z,{className:"mt-[0.2rem] ml-[0.2rem] "}):(0,r.jsx)(I.Z,{className:"mt-[0.2rem] ml-[0.2rem] "})}),(0,r.jsxs)(p.Vq,{children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsxs)("div",{className:" hover:cursor-pointer m-2 w-[45%] h-[3.5rem] border text-gray-500 border-solid rounded-xl grid grid-cols-5 items-center ",children:[(0,r.jsx)("picture",{className:" ml-4 block col-span-1 w-[70%]",children:(0,r.jsx)("img",{className:"rounded-full",src:a.logoURI,alt:"imges"})}),(0,r.jsxs)("div",{className:"ml-3 col-span-4 grid grid-cols-1 text-left w-full",children:[(0,r.jsx)("span",{className:" text-sm",children:a.symbol}),(0,r.jsx)("span",{className:" text-sm",children:(0,T.D2)(a.address)})]})]})}),(0,r.jsxs)(p.cZ,{className:"md:max-w-[560px] ",children:[(0,r.jsx)(p.fK,{children:(0,r.jsx)(p.$N,{className:" text-center",children:"选择兑换代币"})}),(0,r.jsxs)("div",{className:"grid w-full h-full",children:[(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)(B.I,{className:"",value:o,onChange:S,placeholder:"请输入代币合约地址"}),(0,r.jsx)("p",{className:"mt-2 text-center text-red-600",children:d})]}),(0,r.jsx)("ul",{className:"mt-2",children:i.address?(0,r.jsx)("li",{className:" rounded-md p-2 m-1 grid  hover:bg-green-200",value:i.address,onClick:y,children:(0,r.jsxs)(p.GG,{className:"grid w-full grid-cols-5",children:[(0,r.jsxs)("picture",{className:" flex ml-2 col-span-2",children:[(0,r.jsx)("img",{className:"rounded-full w-[35px] h-[35px]",src:i.logoURI,alt:"imges"}),(0,r.jsxs)("div",{className:"grid ml-3",children:[(0,r.jsx)("span",{className:"text-sm  text-left text-gray-500",children:i.symbol}),(0,r.jsx)("span",{className:"text-sm text-left text-gray-500",children:i.name})]})]}),(0,r.jsx)("div",{className:"grid h-full items-center col-span-3",children:(0,r.jsx)("span",{className:" block text-gray-400  text-right mr-5",children:(0,T.D2)(i.address)})})]})}):h.map((e,s)=>(0,r.jsx)("li",{className:" rounded-md p-2 m-1 grid  hover:bg-green-200",value:e.address,onClick:y,children:(0,r.jsxs)(p.GG,{className:"grid w-full grid-cols-5",children:[(0,r.jsxs)("picture",{className:" flex ml-2 col-span-2",children:[(0,r.jsx)("img",{className:"rounded-full w-[35px] h-[35px]",src:e.logoURI,alt:"imges"}),(0,r.jsxs)("div",{className:"grid ml-3",children:[(0,r.jsx)("span",{className:"text-sm  text-left text-gray-500",children:e.symbol}),(0,r.jsx)("span",{className:"text-sm text-left text-gray-500",children:e.name})]})]}),(0,r.jsx)("div",{className:"grid h-full items-center col-span-3",children:(0,r.jsx)("span",{className:" block text-gray-400  text-right mr-5",children:(0,T.D2)(e.address)})})]})},s))})]})]})]})]})]})}var _=a(19160);let L=(0,l.Ue)()((0,o.n)(e=>({swapType:"Raydium",setSwapType:s=>e(e=>{e.swapType=s})})));var M=a(66806);function O(){let{wallets:e,delWallet:s}=d(),{swapType:a}=L(),{baseToken:t,quoteToken:n}=N();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"",children:(0,r.jsxs)(_.iA,{className:" w-full max-h-[400px]",children:[(0,r.jsx)(_.xD,{className:"sticky top-0 z-10 bg-white",children:(0,r.jsxs)(_.SC,{children:[(0,r.jsxs)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:["地址（",Object.keys(e).length,"）"]}),(0,r.jsx)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:"sol余额"}),(0,r.jsxs)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:["基础代币",t.symbol]}),(0,r.jsxs)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:["目标代币",n.symbol]}),(0,r.jsx)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:"操作"})]})}),(0,r.jsx)(_.RM,{children:Object.keys(e).length>0&&Object.values(e).map((e,a)=>{var i,l;return(0,r.jsxs)(_.SC,{className:"",children:[(0,r.jsx)(_.pj,{className:" p-2 pl-4 text-sm text-gray-500",children:(0,T.D2)(e.address)}),(0,r.jsxs)(_.pj,{className:" p-2 text-center",children:[(0,T.az)(e.solBalance,9)," "]}),(0,r.jsx)(_.pj,{className:" p-2 text-center",children:(0,T.az)(null===(i=e.tokens[t.address])||void 0===i?void 0:i.balance,t.decimals)}),(0,r.jsx)(_.pj,{className:" p-2 text-center",children:(0,T.az)(null===(l=e.tokens[n.address])||void 0===l?void 0:l.balance,n.decimals)}),(0,r.jsx)(_.pj,{className:" p-2 text-center",children:(0,r.jsx)(g.z,{variant:"ghost",onClick:()=>{s(e.address)},children:(0,r.jsx)(M.Z,{className:" w-4 text-red-400"})})})]},a)})})]})})})}var F=a(11950),z=a(6437),U=a(35608);function W(){let{swapSetting:e,setSwapSetting:s,nowPrice:a}=E(),{quoteToken:t}=S(),{conn:n,setRpc:i}=k(),[l,o]=(0,u.useState)("0.01"),[c,d]=(0,u.useState)("0.02"),[m,p]=(0,u.useState)("2"),[h,x]=(0,u.useState)("4"),[f,y]=(0,u.useState)("5"),[b,w]=(0,u.useState)("0.01"),[j,N]=(0,u.useState)(""),[T,R]=(0,u.useState)("0.000001"),[P,C]=(0,u.useState)("openbook");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid mt-1 p-1",children:[(0,r.jsxs)("span",{className:"ml-2 text-gray-800",children:["RPC:",(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"（默认rpc是公共的，需要更丝滑的交易请输入您的rpc）"})]}),(0,r.jsx)(B.I,{className:"text-sm text-gray-500 mt-1 w-full",placeholder:"正在使用默认rpc",value:j,onChange:e=>{if(N(e.target.value),e.target.value)try{i(e.target.value)}catch(e){console.log(n.rpcEndpoint),console.log(e)}else i(v.rpc)}})]}),(0,r.jsxs)("div",{className:"mt-2 flex ",children:[(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1  text-gray-800",children:"间隔(秒):"}),(0,r.jsx)(B.I,{value:m,onChange:e=>{p(e.target.value),s({timeMin:Number(e.target.value)})},className:" w-[15%] ml-1",placeholder:"最小（秒）"}),(0,r.jsx)("div",{className:"pt-2 ml-1 mr-1 text-center items-center",children:"~"}),(0,r.jsx)(B.I,{value:h,className:"w-[20%]",onChange:e=>{x(e.target.value),s({timeMax:Number(e.target.value)})},placeholder:"最大（秒）"}),(0,r.jsx)("div",{className:" pt-2 ml-1 mr-1 text-gray-800",children:"滑点(%):"}),(0,r.jsx)(B.I,{value:f,className:"w-[15%]",onChange:e=>{y(e.target.value),s({slippage:Number(e.target.value)})}})]}),(0,r.jsxs)("div",{className:"mt-2 flex gap-3",children:[(0,r.jsxs)("div",{className:"flex mt-2 ml-2 w-[40%]",children:[(0,r.jsx)("span",{className:" inline-block text-gray-800",children:"金额:"}),(0,r.jsxs)(U.E,{className:"flex ml-4",value:e.amountType,onValueChange:e=>s({amountType:e}),defaultValue:"fixed gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"all",id:"r1"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"全部"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"random",id:"r2"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"随机"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"fixed",id:"r3"}),(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"固定"})]})]})]}),(0,r.jsxs)("div",{className:"h-8 w-[60%]",children:["random"==e.amountType&&(0,r.jsxs)("div",{className:"ml-4 flex gap-3",children:[(0,r.jsx)(B.I,{value:l,onChange:e=>{o(e.target.value),s({amountMin:Number(e.target.value)})}}),(0,r.jsx)("span",{className:"mt-2",children:"~"}),(0,r.jsx)(B.I,{value:c,onChange:e=>{d(e.target.value),s({amountMax:Number(e.target.value)})}})]}),"fixed"==e.amountType&&(0,r.jsx)("div",{className:"ml-4 flex gap-3",children:(0,r.jsx)(B.I,{value:c,onChange:e=>{d(e.target.value),s({amountMax:Number(e.target.value)})}})})]})]}),(0,r.jsxs)("div",{className:"mt-5 flex flex-auto ",children:[(0,r.jsxs)("div",{className:"flex min-w-[29%]",children:[(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1 text-gray-800",children:"模式:"}),(0,r.jsxs)(U.E,{className:"ml-4 flex",onValueChange:e=>s({swapType:e}),defaultValue:"pumping",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"pumping",id:"r1"}),(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"拉盘"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"dumping",id:"r2"}),(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"砸盘"})]})]})]}),(0,r.jsx)("span",{className:" pt-2 ml-5 mr-1 min-w-[10%] text-gray-800",children:"目标价格:"}),(0,r.jsx)(B.I,{value:b,className:" ml-3 w-full",onChange:e=>{w(e.target.value),s({targetPrice:Number(e.target.value)})},placeholder:"输入目标价格"})]}),(0,r.jsxs)("div",{className:"mt-3 grid ",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1 text-gray-800",children:"Jito小费:"}),(0,r.jsx)(g.z,{onClick:()=>{R("0.000001"),s({fee:Number("0.000001")})},className:" w-[4rem]"+("0.000001"==T?" bg-green-300":""),variant:"outline",children:"默认"}),(0,r.jsx)(g.z,{onClick:()=>{R("0.00005"),s({fee:Number("0.00005")})},className:"ml-1"+("0.00005"==T?" bg-green-300":""),variant:"outline",children:"快速"}),(0,r.jsx)(g.z,{onClick:()=>{R("0.0001"),s({fee:Number("0.0001")})},className:"ml-1"+("0.0001"==T?" bg-green-300":""),variant:"outline",children:"超快速"}),(0,r.jsxs)("div",{className:"ml-5 flex w-[57%] relative",children:[(0,r.jsx)(B.I,{value:T,onChange:e=>{R(e.target.value),s({fee:Number(e.target.value)})},className:"ml-2 w-full"}),(0,r.jsx)(g.z,{className:"right-0 absolute",disabled:!0,variant:"ghost",children:"Sol"})]})]}),(0,r.jsxs)("div",{className:"mt-1 text-red-400 text-center text-lg ",children:["当前价格: ",a.toFixed(18)," SOL"]})]})]})}function V(){let{wallets:e,setSolBalance:s,setTokenBalance:a,addToken:t}=d(),{conn:n}=k(),[i,l]=(0,u.useState)(!1),o=async()=>{for(let r of(l(!0),Object.values(e))){let e=await n.getBalance(r.keypair.publicKey,"confirmed");s(r.address,e),a(r.address,"So11111111111111111111111111111111111111112",e);try{let e=await fetch(v.heliseRpc,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"1",method:"getTokenAccounts",params:{owner:r.address,page:1,limit:100,displayOptions:{showZeroBalance:!1}}})}),{result:s}=await e.json();for(let e of s.token_accounts){let s={account:e.address,balance:e.amount,address:e.mint,mint:e.mint,name:"",decimals:0,symbol:"",logoURI:""};t(r.address,e.mint,s)}}catch(e){console.log(e)}await (0,T._v)(200),l(!1)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g.z,{variant:"outline",loading:i,onClick:o,children:"刷新余额"})})}var q=a(49030);function D(){let{logs:e}=R();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(q.x,{className:"h-72 w-full flex-col gap-1 verflow-auto flex mt-3 rounded-md border",children:e.length>0&&e.map((e,s)=>(0,r.jsxs)("div",{className:"text-sm m-1 "+("error"===e.logType?"text-red-400":"success"===e.logType?"text-green-400":"info"===e.logType?"text-gray-600":""),children:[(0,r.jsxs)("span",{className:"text-sm",children:[e.logTime," "]}),(0,r.jsxs)("span",{className:" text-sm inline-block  whitespace-pre-wrap",children:[e.message," "," ",e.address&&"(钱包地址:".concat((0,T.D2)(e.address),")")]}),e.tx&&(0,r.jsx)("span",{className:" text-sm",children:(0,r.jsxs)("a",{href:"https://solscan.io/tx/".concat(e.tx),rel:"noreferrer",target:"_blank",children:[" ","查看哈希"]})})]},s))})})}var Z=a(19716),J=a(5354),G=a(59327),H=a(9309),Q=a(38669),Y=a(23663).Buffer;async function X(e,s,a){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=m.ComputeBudgetProgram.setComputeUnitLimit({units:14e5}),r=new m.Transaction().add(n);return t>0&&r.add(m.SystemProgram.transfer({fromPubkey:a,toPubkey:new m.PublicKey(v.jitoTipAccount),lamports:m.LAMPORTS_PER_SOL*t})),v.usePumpFee>0&&r.add(m.SystemProgram.transfer({fromPubkey:a,toPubkey:new m.PublicKey(v.FEE_WALLET),lamports:m.LAMPORTS_PER_SOL*Number(v.usePumpFee)})),r.add(...s),r.feePayer=a,r}function $(e){let s=Y.alloc(8);return s.writeBigUInt64LE(BigInt(e)),s}async function ee(e,s,a){let t=!1,n=!1,r=new Date;for(;!t&&!n;){let{value:i}=await s.getSignatureStatus(e);if(i&&("confirmed"===i.confirmationStatus||"finalized"===i.confirmationStatus)){n=!0;let e=(new Date().getTime()-r.getTime())/1e3;return console.log("Transaction Success. Elapsed time: ".concat(e," seconds.")),!0}if(t=await s.getBlockHeight("finalized")-a>150){let e=(new Date().getTime()-r.getTime())/1e3;return console.log("Blockhash has expired. Elapsed time: ".concat(e," seconds.")),!1}await (0,T._v)(1500)}return n}async function es(e,s){let a=e+"/api/v1/bundles";""==e&&(a=(await et())[0].server+"/api/v1/bundles");let t=[f().encode(s.serialize())],n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"sendBundle",params:[t]})});if(200!==n.status)throw Error("Failed to send transaction");return await n.json()}async function ea(e){let s=performance.now();try{let s=await fetch(e+"/api/v1/bundles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getBundleStatuses",params:[["892b79ed49138bfb3aa5441f0df6e06ef34f9ee8f3976c15b323605bae0cf51d"]]})});if(!s.ok)throw Error("Request failed with status ".concat(s.status))}catch(s){return console.error("Error fetching ".concat(e,":"),s),Number.MAX_SAFE_INTEGER}return Math.floor(performance.now()-s)}async function et(){let e=await Promise.all(v.jitoApi.map(async e=>{let s=await ea(e);return{server:e,latency:s}}));return e.sort((e,s)=>e.latency-s.latency),e}var en=a(64170),er=a(43203),ei=a(35634);class el{getInitialBuyPrice(e){if(e<=0n)return 0n;let s=this.initialVirtualSolReserves*this.initialVirtualTokenReserves,a=this.initialVirtualSolReserves+e,t=this.initialVirtualTokenReserves-(s/a+1n);return t<this.initialRealTokenReserves?t:this.initialRealTokenReserves}static fromBuffer(e){let s=(0,ei.struct)([(0,ei.u64)("discriminator"),(0,ei.bool)("initialized"),(0,ei.publicKey)("authority"),(0,ei.publicKey)("feeRecipient"),(0,ei.u64)("initialVirtualTokenReserves"),(0,ei.u64)("initialVirtualSolReserves"),(0,ei.u64)("initialRealTokenReserves"),(0,ei.u64)("tokenTotalSupply"),(0,ei.u64)("feeBasisPoints")]).decode(e);return new el(BigInt(s.discriminator),s.initialized,s.authority,s.feeRecipient,BigInt(s.initialVirtualTokenReserves),BigInt(s.initialVirtualSolReserves),BigInt(s.initialRealTokenReserves),BigInt(s.tokenTotalSupply),BigInt(s.feeBasisPoints))}constructor(e,s,a,t,n,r,i,l,o){this.initialized=!1,this.discriminator=e,this.initialized=s,this.authority=a,this.feeRecipient=t,this.initialVirtualTokenReserves=n,this.initialVirtualSolReserves=r,this.initialRealTokenReserves=i,this.tokenTotalSupply=l,this.feeBasisPoints=o}}var eo=a(42819);class ec{getBuyPrice(e){if(this.complete)throw Error("Curve is complete");if(e<=0n)return 0n;let s=this.virtualSolReserves*this.virtualTokenReserves,a=this.virtualSolReserves+e,t=this.virtualTokenReserves-(s/a+1n);return t<this.realTokenReserves?t:this.realTokenReserves}getSellPrice(e,s){if(this.complete)throw Error("Curve is complete");if(e<=0n)return 0n;let a=e*this.virtualSolReserves/(this.virtualTokenReserves+e);return a-a*s/10000n}getMarketCapSOL(){return 0n===this.virtualTokenReserves?0n:this.tokenTotalSupply*this.virtualSolReserves/this.virtualTokenReserves}getFinalMarketCapSOL(e){let s=this.getBuyOutPrice(this.realTokenReserves,e),a=this.virtualSolReserves+s,t=this.virtualTokenReserves-this.realTokenReserves;return 0n===t?0n:this.tokenTotalSupply*a/t}getBuyOutPrice(e,s){let a=e<this.realSolReserves?this.realSolReserves:e,t=a*this.virtualSolReserves/(this.virtualTokenReserves-a)+1n;return t+t*s/10000n}static fromBuffer(e){let s=(0,ei.struct)([(0,ei.u64)("discriminator"),(0,ei.u64)("virtualTokenReserves"),(0,ei.u64)("virtualSolReserves"),(0,ei.u64)("realTokenReserves"),(0,ei.u64)("realSolReserves"),(0,ei.u64)("tokenTotalSupply"),(0,ei.bool)("complete")]).decode(e);return new ec(BigInt(s.discriminator),BigInt(s.virtualTokenReserves),BigInt(s.virtualSolReserves),BigInt(s.realTokenReserves),BigInt(s.realSolReserves),BigInt(s.tokenTotalSupply),s.complete)}constructor(e,s,a,t,n,r,i){this.discriminator=e,this.virtualTokenReserves=s,this.virtualSolReserves=a,this.realTokenReserves=t,this.realSolReserves=n,this.tokenTotalSupply=r,this.complete=i}}var ed=a(34108),em=a.n(ed);let eu="finalized",eg="finalized",ep=(e,s)=>e+e*s/10000n,eh=(e,s)=>e-e*s/10000n;async function ex(e,s,a,t,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:eu,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:eg,l=new m.Transaction;if(n){let e=m.ComputeBudgetProgram.setComputeUnitLimit({units:n.unitLimit}),s=m.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.unitPrice});l.add(e),l.add(s)}l.add(s);let o=await ef(e,a,l,r);o.sign(t);try{let s=await e.sendTransaction(o,{skipPreflight:!1});console.log("sig:","https://solscan.io/tx/".concat(s));let a=await ev(e,s,r,i);if(!a)return{success:!1,error:"Transaction failed"};return{success:!0,signature:s,results:a}}catch(s){return s instanceof m.SendTransactionError?console.log(await s.getLogs(e)):console.error(s),{error:s,success:!1}}}let ef=async function(e,s,a){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eu,n=(await e.getLatestBlockhash(t)).blockhash,r=new m.TransactionMessage({payerKey:s,recentBlockhash:n,instructions:a.instructions}).compileToV0Message();return new m.VersionedTransaction(r)},ev=async function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eu,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eg,n=await e.getLatestBlockhash();return await e.confirmTransaction({blockhash:n.blockhash,lastValidBlockHeight:n.lastValidBlockHeight,signature:s},a),e.getTransaction(s,{maxSupportedTransactionVersion:0,commitment:t})};var ey=JSON.parse('{"address":"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P","metadata":{"name":"pump","version":"0.1.0","spec":"0.1.0"},"instructions":[{"name":"initialize","discriminator":[175,175,109,31,13,152,155,237],"docs":["Creates the global state."],"accounts":[{"name":"global","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,111,98,97,108]}]}},{"name":"user","writable":true,"signer":true},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[]},{"name":"setParams","discriminator":[165,31,134,53,189,180,130,255],"docs":["Sets the global state parameters."],"accounts":[{"name":"global","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,111,98,97,108]}]}},{"name":"user","writable":true,"signer":true},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"event_authority","address":"Ce6TQqeHC9p8KetsN6JsjHK7UTZk7nasjjnr7XxXp9F1"},{"name":"program","address":"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"}],"args":[{"name":"feeRecipient","type":"pubkey"},{"name":"initialVirtualTokenReserves","type":"u64"},{"name":"initialVirtualSolReserves","type":"u64"},{"name":"initialRealTokenReserves","type":"u64"},{"name":"tokenTotalSupply","type":"u64"},{"name":"feeBasisPoints","type":"u64"}]},{"name":"create","discriminator":[24,30,200,40,5,28,7,119],"docs":["Creates a new coin and bonding curve."],"accounts":[{"name":"mint","writable":true,"signer":true},{"name":"mint_authority","pda":{"seeds":[{"kind":"const","value":[109,105,110,116,45,97,117,116,104,111,114,105,116,121]}]}},{"name":"bonding_curve","writable":true,"pda":{"seeds":[{"kind":"const","value":[98,111,110,100,105,110,103,45,99,117,114,118,101]},{"kind":"account","path":"mint"}]}},{"name":"associated_bonding_curve","writable":true,"signer":false},{"name":"global","writable":false,"pda":{"seeds":[{"kind":"const","value":[103,108,111,98,97,108]}]}},{"name":"mpl_token_metadata","address":"metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"},{"name":"metadata","writable":true,"signer":false},{"name":"user","isMut":true,"isSigner":true},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{"name":"rent","address":"SysvarRent111111111111111111111111111111111"},{"name":"event_authority","address":"Ce6TQqeHC9p8KetsN6JsjHK7UTZk7nasjjnr7XxXp9F1"},{"name":"program","address":"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"}],"args":[{"name":"name","type":"string"},{"name":"symbol","type":"string"},{"name":"uri","type":"string"}]},{"name":"buy","discriminator":[102,6,61,18,1,218,235,234],"docs":["Buys tokens from a bonding curve."],"accounts":[{"name":"global","pda":{"seeds":[{"kind":"const","value":[103,108,111,98,97,108]}]}},{"name":"fee_recipient","writable":true,"signer":false},{"name":"mint","writable":false,"signer":false},{"name":"bonding_curve","writable":true,"pda":{"seeds":[{"kind":"const","value":[98,111,110,100,105,110,103,45,99,117,114,118,101]},{"kind":"account","path":"mint"}]}},{"name":"associated_bonding_curve","writable":true,"signer":false},{"name":"associated_user","writable":true,"signer":false},{"name":"user","writable":true,"signer":true},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"rent","address":"SysvarRent111111111111111111111111111111111"},{"name":"event_authority","address":"Ce6TQqeHC9p8KetsN6JsjHK7UTZk7nasjjnr7XxXp9F1"},{"name":"program","address":"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"}],"args":[{"name":"amount","type":"u64"},{"name":"maxSolCost","type":"u64"}]},{"name":"sell","discriminator":[51,230,133,164,1,127,131,173],"docs":["Sells tokens into a bonding curve."],"accounts":[{"name":"global","writable":false,"pda":{"seeds":[{"kind":"const","value":[103,108,111,98,97,108]}]}},{"name":"feeRecipient","writable":true,"signer":false},{"name":"mint","writable":false,"signer":false},{"name":"bonding_curve","writable":true,"pda":{"seeds":[{"kind":"const","value":[98,111,110,100,105,110,103,45,99,117,114,118,101]},{"kind":"account","path":"mint"}]}},{"name":"associatedBondingCurve","writable":true,"signer":false},{"name":"associatedUser","writable":true,"signer":false},{"name":"user","writable":true,"signer":true},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"associated_token_program","address":"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"event_authority","address":"Ce6TQqeHC9p8KetsN6JsjHK7UTZk7nasjjnr7XxXp9F1"},{"name":"program","address":"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"}],"args":[{"name":"amount","type":"u64"},{"name":"minSolOutput","type":"u64"}]},{"name":"withdraw","discriminator":[183,18,70,156,148,109,161,34],"docs":["Allows the admin to withdraw liquidity for a migration once the bonding curve completes"],"accounts":[{"name":"global","writable":false,"pda":{"seeds":[{"kind":"const","value":[103,108,111,98,97,108]}]}},{"name":"lastWithdraw","writable":true,"signer":false},{"name":"mint","writable":false,"signer":false},{"name":"bonding_curve","writable":true,"pda":{"seeds":[{"kind":"const","value":[98,111,110,100,105,110,103,45,99,117,114,118,101]},{"kind":"account","path":"mint"}]}},{"name":"associatedBondingCurve","writable":true,"signer":false},{"name":"associatedUser","writable":true,"signer":false},{"name":"user","writable":true,"signer":true},{"name":"system_program","address":"11111111111111111111111111111111"},{"name":"token_program","address":"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{"name":"rent","address":"SysvarRent111111111111111111111111111111111"},{"name":"event_authority","address":"Ce6TQqeHC9p8KetsN6JsjHK7UTZk7nasjjnr7XxXp9F1"},{"name":"program","address":"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"}],"args":[]}],"accounts":[{"name":"BondingCurve","discriminator":[23,183,248,55,96,216,172,96]},{"name":"Global","discriminator":[167,232,232,177,200,108,114,127]}],"events":[{"name":"CreateEvent","discriminator":[27,114,169,77,222,235,99,118]},{"name":"TradeEvent","discriminator":[189,219,127,211,78,230,97,238]},{"name":"CompleteEvent","discriminator":[95,114,97,156,212,46,152,8]},{"name":"SetParamsEvent","discriminator":[223,195,159,246,62,48,143,131]}],"types":[{"name":"Global","type":{"kind":"struct","fields":[{"name":"initialized","type":"bool"},{"name":"authority","type":"pubkey"},{"name":"feeRecipient","type":"pubkey"},{"name":"initialVirtualTokenReserves","type":"u64"},{"name":"initialVirtualSolReserves","type":"u64"},{"name":"initialRealTokenReserves","type":"u64"},{"name":"tokenTotalSupply","type":"u64"},{"name":"feeBasisPoints","type":"u64"}]}},{"name":"LastWithdraw","type":{"kind":"struct","fields":[{"name":"lastWithdrawTimestamp","type":"i64"}]}},{"name":"BondingCurve","type":{"kind":"struct","fields":[{"name":"virtualTokenReserves","type":"u64"},{"name":"virtualSolReserves","type":"u64"},{"name":"realTokenReserves","type":"u64"},{"name":"realSolReserves","type":"u64"},{"name":"tokenTotalSupply","type":"u64"},{"name":"complete","type":"bool"}]}},{"name":"CreateEvent","type":{"kind":"struct","fields":[{"name":"name","type":"string","index":false},{"name":"symbol","type":"string","index":false},{"name":"uri","type":"string","index":false},{"name":"mint","type":"pubkey","index":false},{"name":"bondingCurve","type":"pubkey","index":false},{"name":"user","type":"pubkey","index":false}]}},{"name":"TradeEvent","type":{"kind":"struct","fields":[{"name":"mint","type":"pubkey","index":false},{"name":"solAmount","type":"u64","index":false},{"name":"tokenAmount","type":"u64","index":false},{"name":"isBuy","type":"bool","index":false},{"name":"user","type":"pubkey","index":false},{"name":"timestamp","type":"i64","index":false},{"name":"virtualSolReserves","type":"u64","index":false},{"name":"virtualTokenReserves","type":"u64","index":false},{"name":"realSolReserves","type":"u64","index":false},{"name":"realTokenReserves","type":"u64","index":false}]}},{"name":"CompleteEvent","type":{"kind":"struct","fields":[{"name":"user","type":"pubkey","index":false},{"name":"mint","type":"pubkey","index":false},{"name":"bondingCurve","type":"pubkey","index":false},{"name":"timestamp","type":"i64","index":false}]}},{"name":"SetParamsEvent","type":{"kind":"struct","fields":[{"name":"feeRecipient","type":"pubkey","index":false},{"name":"initialVirtualTokenReserves","type":"u64","index":false},{"name":"initialVirtualSolReserves","type":"u64","index":false},{"name":"initialRealTokenReserves","type":"u64","index":false},{"name":"tokenTotalSupply","type":"u64","index":false},{"name":"feeBasisPoints","type":"u64","index":false}]}}],"errors":[{"code":6000,"name":"NotAuthorized","msg":"The given account is not authorized to execute this instruction."},{"code":6001,"name":"AlreadyInitialized","msg":"The program is already initialized."},{"code":6002,"name":"TooMuchSolRequired","msg":"slippage: Too much SOL required to buy the given amount of tokens."},{"code":6003,"name":"TooLittleSolReceived","msg":"slippage: Too little SOL received to sell the given amount of tokens."},{"code":6004,"name":"MintDoesNotMatchBondingCurve","msg":"The mint does not match the bonding curve."},{"code":6005,"name":"BondingCurveComplete","msg":"The bonding curve has completed and liquidity migrated to raydium."},{"code":6006,"name":"BondingCurveNotComplete","msg":"The bonding curve has not completed."},{"code":6007,"name":"NotInitialized","msg":"The program is not initialized."},{"code":6008,"name":"WithdrawTooFrequent","msg":"Withdraw too frequent"}]}'),eb=a(23663).Buffer;class ew{async buy(e,s,a){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500n,n=arguments.length>4?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:eu,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:eg,l=await this.getBondingCurveAccount(s,r);if(!l)return{success:!1,error:"Bonding curve account not found"};let o=l.getBuyPrice(a),c=ep(a,t);console.log("buying ".concat(Number(o)/1e6," for: ").concat(Number(c)/m.LAMPORTS_PER_SOL," SOL (").concat(Number(c),")"));let d=await this.getGlobalAccount(r),u=await this.getBuyInstructions(e.publicKey,s,d.feeRecipient,o,c);return await ex(this.connection,u,e.publicKey,[e],n,r,i)}async sell(e,s,a){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500n,n=arguments.length>4?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:eu,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:eg,l=await this.getBondingCurveAccount(s);if(!l)return{success:!1,error:"Bonding curve account not found"};let o=await this.getGlobalAccount(),c=eh(l.getSellPrice(a,o.feeBasisPoints),t);console.log("selling ".concat(Number(a)/1e6," for: ").concat(Number(c)/m.LAMPORTS_PER_SOL," SOL"));let d=await this.getSellInstructions(e.publicKey,s,o.feeRecipient,a,c);return await ex(this.connection,d,e.publicKey,[e],n,r,i)}async getCreateInstructions(e,s,a,t,n){let r=new m.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),[i]=m.PublicKey.findProgramAddressSync([eb.from("metadata"),r.toBuffer(),n.publicKey.toBuffer()],r),l=await (0,G.Am)(n.publicKey,this.getBondingCurvePDA(n.publicKey),!0);return this.program.methods.create(s,a,t).accounts({mint:n.publicKey,associatedBondingCurve:l,metadata:i,user:e}).signers([n]).transaction()}async getBuyInstructions(e,s,a,t,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:eu,i=await (0,G.Am)(s,this.getBondingCurvePDA(s),!0),l=await (0,G.Am)(s,e,!1),o=new m.Transaction;try{await (0,eo.D0)(this.connection,l,r)}catch(a){o.add((0,H.Ek)(e,l,e,s))}return o.add(await this.program.methods.buy(new ed.BN(t.toString()),new ed.BN(n.toString())).accounts({feeRecipient:a,mint:s,associatedBondingCurve:i,associatedUser:l,user:e}).transaction()),o}async getSellInstructions(e,s,a,t,n){let r=await (0,G.Am)(s,this.getBondingCurvePDA(s),!0),i=await (0,G.Am)(s,e,!1),l=new m.Transaction;return l.add(await this.program.methods.sell(new ed.BN(t.toString()),new ed.BN(n.toString())).accounts({feeRecipient:a,mint:s,associatedBondingCurve:r,associatedUser:i,user:e}).transaction()),l}async getBondingCurveAccount(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eu,a=await this.connection.getAccountInfo(this.getBondingCurvePDA(e),s);return a?ec.fromBuffer(a.data):null}async getGlobalAccount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eu,[s]=m.PublicKey.findProgramAddressSync([eb.from("global")],new m.PublicKey("6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"));console.log("globalAccountPDA",s.toBase58());let a=await this.connection.getAccountInfo(s,e);return el.fromBuffer(a.data)}getBondingCurvePDA(e){return m.PublicKey.findProgramAddressSync([eb.from("bonding-curve"),e.toBuffer()],this.program.programId)[0]}addEventListener(e,s){return this.program.addEventListener(e,(a,t,n)=>{switch(e){case"createEvent":s({name:a.name,symbol:a.symbol,uri:a.uri,mint:new m.PublicKey(a.mint),bondingCurve:new m.PublicKey(a.bondingCurve),user:new m.PublicKey(a.user)},t,n);break;case"tradeEvent":s({mint:new m.PublicKey(a.mint),solAmount:BigInt(a.solAmount),tokenAmount:BigInt(a.tokenAmount),isBuy:a.isBuy,user:new m.PublicKey(a.user),timestamp:Number(a.timestamp),virtualSolReserves:BigInt(a.virtualSolReserves),virtualTokenReserves:BigInt(a.virtualTokenReserves),realSolReserves:BigInt(a.realSolReserves),realTokenReserves:BigInt(a.realTokenReserves)},t,n);break;case"completeEvent":s({user:new m.PublicKey(a.user),mint:new m.PublicKey(a.mint),bondingCurve:new m.PublicKey(a.bondingCurve),timestamp:a.timestamp},t,n),console.log("completeEvent",a,t,n);break;case"setParamsEvent":s({feeRecipient:new m.PublicKey(a.feeRecipient),initialVirtualTokenReserves:BigInt(a.initialVirtualTokenReserves),initialVirtualSolReserves:BigInt(a.initialVirtualSolReserves),initialRealTokenReserves:BigInt(a.initialRealTokenReserves),tokenTotalSupply:BigInt(a.tokenTotalSupply),feeBasisPoints:BigInt(a.feeBasisPoints)},t,n);break;default:console.error("Unhandled event type:",e)}})}removeEventListener(e){this.program.removeEventListener(e)}constructor(e){this.program=new en.$r(ey,e),this.connection=this.program.provider.connection}}async function ej(e,s){let a=new er.Z(new m.Keypair),t=new en.Y7(s,a,{commitment:"finalized"}),n=new m.PublicKey(e),r=new ew(t),i=await r.getBondingCurveAccount(n);if(!i)return null;let l=r.getBondingCurvePDA(n),o=await (0,G.Am)(n,l,!0);return{virtual_sol_reserves:i.virtualSolReserves.toString(),virtual_token_reserves:i.virtualTokenReserves.toString(),bonding_curve:l.toBase58(),associated_bonding_curve:o.toBase58()}}(t=n||(n={}))[t.Simulation=0]="Simulation",t[t.Execution=1]="Execution";let ek=new m.PublicKey("4wTV1YmiEkRvAtNtsSGPtUrqRYQMe5SKy2uB4Jjaxnjf"),eN=new m.PublicKey("CebN5WGQ4jvEPvsVU4EoHEpgzq1VV7AbicfhtW4xC9iM");new m.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");let eS=new m.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),eT=new m.PublicKey("SysvarRent111111111111111111111111111111111"),eR=new m.PublicKey("6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P"),eP=new m.PublicKey("Ce6TQqeHC9p8KetsN6JsjHK7UTZk7nasjjnr7XxXp9F1"),eB=m.SystemProgram.programId;var eC=a(23663).Buffer;async function eI(e,s,a,t,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.25;try{let o=await ej(t,s);if(!o)throw Error("网络错误，请稍后再试...");let c=a.publicKey,d=new m.PublicKey(t),u=new m.Transaction,g=await (0,G.Am)(d,c,!1);await s.getAccountInfo(g)||u.add((0,H.Ek)(a.publicKey,g,a.publicKey,d));let p=Math.floor(r*Number(o.virtual_token_reserves)/Number(o.virtual_sol_reserves)*(1-l));console.log("tokenOut",p);let h=new m.PublicKey(o.bonding_curve),f=new m.PublicKey(o.associated_bonding_curve),v=[{pubkey:ek,isSigner:!1,isWritable:!1},{pubkey:eN,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:eB,isSigner:!1,isWritable:!1},{pubkey:Q.H_,isSigner:!1,isWritable:!1},{pubkey:eT,isSigner:!1,isWritable:!1},{pubkey:eP,isSigner:!1,isWritable:!1},{pubkey:eR,isSigner:!1,isWritable:!1}],y=eC.concat([$("16927863322537952870"),$(p),$(r)]),b=new m.TransactionInstruction({keys:v,programId:eR,data:y});u.add(b);let w=await X(s,u.instructions,a.publicKey,i);if(e==n.Execution){let e=await s.getLatestBlockhash("confirmed");w.recentBlockhash=e.blockhash,w.feePayer=a.publicKey,w.sign(a);let t=x.encode(w.signature);if(!await es("",w))throw Error("无法发送交易，请检查网络连接");if(!await ee(t,s,e.lastValidBlockHeight))throw Error("交易等待过期，跳过本钱包，您可以增加jito小费来保持较高的成功率");return console.log("Sell transaction confirmed:",t),t}if(e==n.Simulation){let e=await s.simulateTransaction(w);console.log(e)}}catch(e){throw console.log(e),e}}async function eE(e,s,a,t,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;arguments.length>6&&void 0!==arguments[6]&&arguments[6];try{let l=await ej(t,s);if(!l)throw Error("网络错误，请稍后再试...");let o=a.publicKey,c=new m.PublicKey(t),d=new m.Transaction,u=await (0,G.Am)(c,o,!1);await s.getAccountInfo(u)||d.add((0,H.Ek)(a.publicKey,u,a.publicKey,c));let g=[{pubkey:ek,isSigner:!1,isWritable:!1},{pubkey:eN,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:new m.PublicKey(l.bonding_curve),isSigner:!1,isWritable:!0},{pubkey:new m.PublicKey(l.associated_bonding_curve),isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:eB,isSigner:!1,isWritable:!1},{pubkey:eS,isSigner:!1,isWritable:!1},{pubkey:Q.H_,isSigner:!1,isWritable:!1},{pubkey:eP,isSigner:!1,isWritable:!1},{pubkey:eR,isSigner:!1,isWritable:!1}],p=eC.concat([$("12502976635542562355"),$(r),$(0)]),h=new m.TransactionInstruction({keys:g,programId:eR,data:p});d.add(h);let f=await X(s,d.instructions,a.publicKey,i);if(e==n.Execution){let e=await s.getLatestBlockhash("confirmed");f.recentBlockhash=e.blockhash,f.feePayer=a.publicKey,f.sign(a);let t=x.encode(f.signature);if(!await es("",f))throw Error("无法发送交易，请检查网络连接");if(!await ee(t,s,e.lastValidBlockHeight))throw Error("交易等待过期，跳过本钱包，您可以增加jito小费来保持较高的成功率");return console.log("Sell transaction confirmed:",t),t}if(e==n.Simulation){let e=await s.simulateTransaction(f);return console.log(e),""}}catch(e){throw console.log(e),e}}let eK=n.Execution;function eA(){let{wallets:e,setSolBalance:s,setTokenBalance:a,addToken:t}=d(),{conn:n}=k(),{swapSetting:i,taskCount:l,incrementTaskCount:o,clearTaskCount:c,nowPrice:p,setNowPrice:h}=E(),[x,f]=(0,u.useState)(!1),[y,b]=(0,u.useState)(170),[w,j]=(0,u.useState)(!1),{addLog:S,clearLog:T}=R(),{baseToken:B,quoteToken:C}=N(),I=(e,s)=>(e>s&&([e,s]=[s,e]),e===s)?e:e<=0||s<=0?0:s-e<1?e+Math.random()*(s-e):Math.floor(Math.random()*(s-e+1)+e),_=async()=>{try{let e=await (0,K.f)(C.address,n);if(console.log(y),console.log(e),null==e){S("error","不是PUMP代币");return}let s=Number(e.virtual_sol_reserves)/m.LAMPORTS_PER_SOL,a=Number(e.virtual_token_reserves)/1e6;h(s/a)}catch(e){S("error",e.message)}},L=async()=>{j(!0);let e=await q();try{let s=await (0,K.f)(C.address,n);if(console.log(e),console.log(s),null==s){j(!1),S("error","不是PUMP代币");return}let a=Number(s.virtual_sol_reserves)/m.LAMPORTS_PER_SOL,t=Number(s.virtual_token_reserves)/1e6;h(a/t),S("info","查询成功，当前价格"+"".concat((a/t).toFixed(18)," SOL"))}catch(e){S("error",e.message)}j(!1)},M=s=>{var a,t,n,r;if(0==(null!==(t=null===(a=e[s].tokens[B.address])||void 0===a?void 0:a.balance)&&void 0!==t?t:0))return 0;if("fixed"==i.amountType)return i.amountMax*10**B.decimals;if("random"==i.amountType)return I(i.amountMin,i.amountMax)*10**B.decimals;if("all"==i.amountType){let a=null!==(r=null===(n=e[s].tokens[B.address])||void 0===n?void 0:n.balance)&&void 0!==r?r:0;if(a>0)return(a=a-i.fee*m.LAMPORTS_PER_SOL-v.usePumpFee*m.LAMPORTS_PER_SOL-5e3)<0&&(a=0),a}return 0},U=s=>{var a,t,n,r;return 0==(null!==(t=null===(a=e[s].tokens[C.address])||void 0===a?void 0:a.balance)&&void 0!==t?t:0)?0:"fixed"==i.amountType?i.amountMax*10**C.decimals:"random"==i.amountType?I(i.amountMin,i.amountMax)*10**C.decimals:"all"==i.amountType&&null!==(r=null===(n=e[s].tokens[C.address])||void 0===n?void 0:n.balance)&&void 0!==r?r:0},q=async()=>{try{let e=await fetch("https://price.jup.ag/v4/price?ids=So11111111111111111111111111111111111111112"),s=await e.json();return b(s.data.So11111111111111111111111111111111111111112.price),s.data.So11111111111111111111111111111111111111112.price}catch(e){console.error("There was a problem with the fetch operation:",e),S("error","获取SOL价格失败 请检查网络"+e.message)}return"160"},G=async e=>{let r=await n.getBalance(e.keypair.publicKey);if(s(e.address,r),"So11111111111111111111111111111111111111112"===B.address)a(e.address,B.address,Number(r));else{var i;if(e.tokens[B.address]&&(null===(i=e.tokens[B.address])||void 0===i?void 0:i.account)!=""){let s=await n.getTokenAccountBalance(new m.PublicKey(e.tokens[B.address].account));a(e.address,B.address,Number(s.value.amount))}else(await (0,J.tQ)(n,e.keypair.publicKey)).map(s=>{if(s.accountInfo.mint.toBase58()==B.address){let a={account:s.pubkey.toBase58(),balance:Number(s.accountInfo.amount.toString()),address:s.accountInfo.mint.toBase58(),mint:s.accountInfo.mint.toBase58(),name:"",decimals:B.decimals,symbol:"",logoURI:""};t(e.address,s.accountInfo.mint.toBase58(),a)}else a(e.address,B.address,Number(0))})}if("So11111111111111111111111111111111111111112"===C.address)a(e.address,C.address,Number(r));else if(e.tokens[C.address]&&""!=e.tokens[C.address].account){let s=await n.getTokenAccountBalance(new m.PublicKey(e.tokens[C.address].account));a(e.address,C.address,Number(s.value.amount))}else(await (0,J.tQ)(n,e.keypair.publicKey)).map(s=>{if(s.accountInfo.mint.toBase58()==C.address){console.log("account",s.accountInfo.mint.toBase58()),console.log("amount",s.accountInfo.amount.toString());let a={account:s.pubkey.toBase58(),balance:Number(s.accountInfo.amount.toString()),address:s.accountInfo.mint.toBase58(),mint:s.accountInfo.mint.toBase58(),name:"",decimals:C.decimals,symbol:"",logoURI:""};t(e.address,s.accountInfo.mint.toBase58(),a)}})};return(0,Z.Z)(async()=>{var s,a,t,r;if(i.fee<1e-6){S("error","市值机器人使用jito提交打包，手续费至少0.000001 SOL"),f(!1);return}if(await q(),0===Object.keys(e).length){S("error","请添加钱包"),f(!1);return}if(l>=Object.keys(e).length){c();return}S("info","开始执行",Object.values(e)[l].address);let d=Object.values(e)[l];try{await G(d),await _(),console.log("nowPrice: ",p),S("info","当前价格:"+"".concat(p.toFixed(18)))}catch(e){S("error","329更新余额失败 "+e.message),f(!1);return}let u=0;if(console.log(d),"pumping"===i.swapType){if((null===(s=d.tokens[B.address])||void 0===s?void 0:s.balance)==0){S("info","余额0，跳过该钱包"),o();return}if(i.targetPrice<=p){S("success","达到目标价格程序结束"),c(),f(!1);return}if(S("info","拉盘开始"),(u=M(d.address))>(null===(a=d.tokens[B.address])||void 0===a?void 0:a.balance)){S("info","余额不足，跳过该钱包"),o();return}if(0===u){S("error","358 输入价格为0，跳过该钱包"),o();return}}else{if(!d.tokens[C.address]||(null===(t=d.tokens[C.address])||void 0===t?void 0:t.balance)==0){S("info","余额0，跳过该钱包"),o();return}if(i.targetPrice>=p){S("success","达到目标价格程序结束"),c(),f(!1);return}if(S("info","砸盘开始"),(u=U(d.address))>(null===(r=d.tokens[C.address])||void 0===r?void 0:r.balance)){S("info","余额不足，跳过该钱包"),o();return}if(0===u){S("error","交易数量为0，跳过该钱包。",d.address),o();return}}console.log(u=Math.floor(u)),console.log(i.poolType);try{let e;e="pumping"===i.swapType?await eI(eK,n,d.keypair,C.address,u,i.fee,i.slippage/100):await eE(eK,n,d.keypair,C.address,u,i.fee,i.slippage),S("success","执行成功",d.address,e)}catch(e){e instanceof m.TransactionExpiredTimeoutError?S("info","交易等待超时，交易可能成功了，请查看哈希:"+"".concat(e.message),d.address,e.signature):e instanceof m.TransactionExpiredBlockheightExceededError?S("info","交易等待区块高度超时，交易可能成功了，请查看哈希:"+"".concat(e.message),d.address,e.signature):e.message.includes("Transaction simulation failed")?S("error","执行失败，可能是价格变动太大，请调整滑点，跳过该钱包。"+"错误消息：".concat(e.message),d.address):e.message.includes('failed ({"err":{"InstructionError":[4,{"Custom":30}]}}')?S("error","执行失败，可能是价格变动太大，请调整滑点，跳过该钱包。"+"错误消息：".concat(e.message),d.address,e.signature):e.message.includes("amounts must greater than zero")?S("error","执行失败，金额太小，请加大金额，跳过该钱包。"+"错误消息：".concat(e.message),d.address,e.signature):S("error","执行失败 跳过该钱包。"+"".concat(e.message),d.address,e.signature)}let g=I(1e3*i.timeMin,1e3*i.timeMax);S("info","".concat(g/1e3,"秒后")+"执行下一个钱包"),await new Promise(e=>setTimeout(e,g)),o()},x?200:null),(0,r.jsxs)("div",{className:"grid p-3 mt-2 w-[750px]",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsx)(P,{}),(0,r.jsx)(V,{}),(0,r.jsx)(g.z,{onClick:()=>{window.open("https://help.pandatool.org/sol/swapbotpump")},variant:"outline",children:"查看教程"})]}),(0,r.jsx)(O,{}),(0,r.jsx)(A,{}),(0,r.jsx)(W,{}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-4 mt-2",children:[(0,r.jsx)(g.z,{variant:"outline",loading:w,onClick:L,children:"查池子"}),(0,r.jsxs)(g.z,{onClick:()=>{c(),f(!0)},loading:x,variant:"outline",className:"bg-green-400 hover:bg-green-500 hover:text-gray-100 text-white",children:["开始 ",(0,r.jsx)(z.Z,{className:"w-5 h-5 ml-1"})]}),(0,r.jsxs)(g.z,{onClick:()=>{f(!1)},disabled:!x,variant:"outline",className:"bg-red-400 hover:bg-red-500 text-white hover:text-gray-100",children:["停止 ",(0,r.jsx)(F.Z,{className:"w-5 h-5 ml-1"})]}),(0,r.jsx)(g.z,{variant:"outline",onClick:T,children:"清空日志"})]}),(0,r.jsx)(D,{}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("h4",{className:"text-gray-500 text-sm ",children:[" ","每笔交易收费",v.usePumpFee," SOL"]})})]})}function e_(){let[e,s]=(0,u.useState)("2T7wBXqKT6WTL5amE45z859pm5QoftufV1ShpEYP1Dn1HivimxotLbi6vpSemWkKKYiBzCCLPEyoyyc8Vmq7Vk2"),{wallets:a,addWallet:t,delAllWallets:n}=c(),{conn:i}=k(),{addLog:l}=R(),{baseToken:o,quoteToken:d}=S(),[f,v]=(0,u.useState)(!1),y=async()=>{v(!0);let s=e.split("\n");for(let e=0;e<s.length;e++)try{let a=m.Keypair.fromSecretKey(x.decode(s[e].trim())),n=await i.getBalance(a.publicKey),r={},l=0,c=0;"So11111111111111111111111111111111111111112"==o.address&&(l=n),"So11111111111111111111111111111111111111112"==d.address&&(c=n),r[o.address]={account:"",balance:l,mint:o.address,address:o.address,name:o.name,decimals:o.decimals,symbol:o.symbol,logoURI:o.logoURI},r[d.address]={account:"",balance:c,mint:d.address,address:d.address,name:d.name,decimals:d.decimals,symbol:d.symbol,logoURI:d.logoURI},t({address:a.publicKey.toBase58(),solBalance:n,keypair:a,tokens:r})}catch(s){s.message.includes("403")?l("error","rpc请求失败，请检查网络连接。或者更换rpc节点"):l("error","第".concat(e+1,"行私钥有误，已忽略该行"))}v(!1)};return(0,r.jsxs)(p.Vq,{children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsx)(g.z,{variant:"outline",loading:f,children:"导入钱包"})}),(0,r.jsxs)(p.cZ,{className:"md:max-w-[700px] ",children:[(0,r.jsxs)(p.fK,{children:[(0,r.jsx)(p.$N,{className:" text-center",children:"导入钱包"}),(0,r.jsx)(p.Be,{className:" text-sm text-center",children:"(私钥一行一个)"})]}),(0,r.jsx)("div",{className:"grid w-full h-full",children:(0,r.jsx)(h.g,{className:"h-full min-h-[400px] text-[0.7rem] text-red-400",value:e,onChange:e=>{s(e.target.value)},placeholder:"填入私钥一行一个",id:"message"})}),(0,r.jsx)(p.cN,{className:"mr-2",children:(0,r.jsx)(p.GG,{asChild:!0,children:(0,r.jsx)(g.z,{variant:"default",onClick:y,type:"submit",children:"导入"})})})]})]})}function eL(){let{swapSetting:e}=E(),{baseToken:s,quoteToken:a,setBaseToken:t,setQuoteToken:n}=S(),[i,l]=(0,u.useState)({}),[o,c]=(0,u.useState)(""),[d,g]=(0,u.useState)(""),[h,x]=(0,u.useState)(b),f=e=>{let s=e.currentTarget.getAttribute("value");h.map(e=>{e.address===s&&n(e)})},w=e=>{let s=e.currentTarget.getAttribute("value");y.map(e=>e.address===s&&t(e))},j=async e=>{let s=e.target.value;if(l({}),c(s),g(""),""==s)return;let a=h.find(e=>e.address===s);if(a){l(a);return}g("查询中。。。");try{let e=new m.PublicKey(s),a=await fetch(v.heliseRpc,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"text",method:"getAsset",params:{id:e.toBase58()}})}),t=await a.json(),n="未知",r="未知",i="/image/unknow.svg",o=0;t.result.content&&(n=t.result.content.metadata.name,r=t.result.content.metadata.symbol,i=t.result.content.links.image),o=t.result.token_info.decimals;let c={account:"",balance:0,address:e.toBase58(),decimals:o,name:n,symbol:r,logoURI:i};x([...h,c]),g(""),l(c)}catch(e){g("找不到代币")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2  mt-4",children:[(0,r.jsxs)("span",{className:"ml-3 text-gray-600 font-bold",children:["基础代币",(0,r.jsx)("span",{className:" text-sm font-light",children:"（价值币）"})]}),(0,r.jsxs)("span",{className:"ml-10 text-gray-600 font-bold",children:["目标代币",(0,r.jsx)("span",{className:" text-sm font-light",children:"（土狗币）"})]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)(p.Vq,{children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsxs)("div",{className:" hover:cursor-pointer m-2 w-[45%] h-[3.5rem] border border-solid rounded-xl text-gray-500 grid grid-cols-5 items-center ",children:[(0,r.jsx)("picture",{className:" ml-4 block col-span-1 w-[70%]",children:(0,r.jsx)("img",{className:"rounded-full",src:s.logoURI,alt:"imges"})}),(0,r.jsxs)("div",{className:" ml-3 col-span-4 grid grid-cols-1 text-left w-full",children:[(0,r.jsx)("span",{className:" text-sm",children:s.symbol}),(0,r.jsx)("span",{className:" text-sm",children:(0,T.D2)(s.address)})]})]})}),(0,r.jsxs)(p.cZ,{className:"md:max-w-[560px]  ",children:[(0,r.jsx)(p.fK,{children:(0,r.jsx)(p.$N,{className:" text-center",children:"选择基础代币"})}),(0,r.jsx)("div",{className:"grid w-full h-full",children:(0,r.jsx)("ul",{className:"mt-2",children:y.map((e,s)=>(0,r.jsx)("li",{className:" rounded-md p-2 m-1 grid  hover:bg-green-200",value:e.address,onClick:w,children:(0,r.jsxs)(p.GG,{className:"grid w-full grid-cols-5",children:[(0,r.jsxs)("picture",{className:" flex ml-2 col-span-2",children:[(0,r.jsx)("img",{className:"rounded-full w-[35px] h-[35px]",src:e.logoURI,alt:"imges"}),(0,r.jsxs)("div",{className:"grid ml-3",children:[(0,r.jsx)("span",{className:"text-sm  text-left text-gray-500",children:e.symbol}),(0,r.jsx)("span",{className:"text-sm text-left text-gray-500",children:e.name})]})]}),(0,r.jsx)("div",{className:"grid h-full items-center col-span-3",children:(0,r.jsx)("span",{className:" block text-gray-400  text-right mr-5",children:(0,T.D2)(e.address)})})]})},s))})})]})]}),(0,r.jsx)("div",{className:" items-center m-3 mt-[0.8rem] p-1 w-[2.5rem] h-[2.5rem] hover:cursor-pointer hover:bg-green-100 rounded-full ",children:"pumping"==e.swapType?(0,r.jsx)(C.Z,{className:"mt-[0.2rem] ml-[0.2rem] "}):(0,r.jsx)(I.Z,{className:"mt-[0.2rem] ml-[0.2rem] "})}),(0,r.jsxs)(p.Vq,{children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsxs)("div",{className:" hover:cursor-pointer m-2 w-[45%] h-[3.5rem] border text-gray-500 border-solid rounded-xl grid grid-cols-5 items-center ",children:[(0,r.jsx)("picture",{className:" ml-4 block col-span-1 w-[70%]",children:(0,r.jsx)("img",{className:"rounded-full",src:a.logoURI,alt:"imges"})}),(0,r.jsxs)("div",{className:"ml-3 col-span-4 grid grid-cols-1 text-left w-full",children:[(0,r.jsx)("span",{className:" text-sm",children:a.symbol}),(0,r.jsx)("span",{className:" text-sm",children:(0,T.D2)(a.address)})]})]})}),(0,r.jsxs)(p.cZ,{className:"md:max-w-[560px] ",children:[(0,r.jsx)(p.fK,{children:(0,r.jsx)(p.$N,{className:" text-center",children:"选择兑换代币"})}),(0,r.jsxs)("div",{className:"grid w-full h-full",children:[(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)(B.I,{className:"",value:o,onChange:j,placeholder:"请输入代币合约地址"}),(0,r.jsx)("p",{className:"mt-2 text-center text-red-600",children:d})]}),(0,r.jsx)("ul",{className:"mt-2",children:i.address?(0,r.jsx)("li",{className:" rounded-md p-2 m-1 grid  hover:bg-green-200",value:i.address,onClick:f,children:(0,r.jsxs)(p.GG,{className:"grid w-full grid-cols-5",children:[(0,r.jsxs)("picture",{className:" flex ml-2 col-span-2",children:[(0,r.jsx)("img",{className:"rounded-full w-[35px] h-[35px]",src:i.logoURI,alt:"imges"}),(0,r.jsxs)("div",{className:"grid ml-3",children:[(0,r.jsx)("span",{className:"text-sm  text-left text-gray-500",children:i.symbol}),(0,r.jsx)("span",{className:"text-sm text-left text-gray-500",children:i.name})]})]}),(0,r.jsx)("div",{className:"grid h-full items-center col-span-3",children:(0,r.jsx)("span",{className:" block text-gray-400  text-right mr-5",children:(0,T.D2)(i.address)})})]})}):h.map((e,s)=>(0,r.jsx)("li",{className:" rounded-md p-2 m-1 grid  hover:bg-green-200",value:e.address,onClick:f,children:(0,r.jsxs)(p.GG,{className:"grid w-full grid-cols-5",children:[(0,r.jsxs)("picture",{className:" flex ml-2 col-span-2",children:[(0,r.jsx)("img",{className:"rounded-full w-[35px] h-[35px]",src:e.logoURI,alt:"imges"}),(0,r.jsxs)("div",{className:"grid ml-3",children:[(0,r.jsx)("span",{className:"text-sm  text-left text-gray-500",children:e.symbol}),(0,r.jsx)("span",{className:"text-sm text-left text-gray-500",children:e.name})]})]}),(0,r.jsx)("div",{className:"grid h-full items-center col-span-3",children:(0,r.jsx)("span",{className:" block text-gray-400  text-right mr-5",children:(0,T.D2)(e.address)})})]})},s))})]})]})]})]})]})}function eM(){let{wallets:e,delWallet:s}=c(),{swapType:a}=L(),{baseToken:t,quoteToken:n}=S();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"",children:(0,r.jsxs)(_.iA,{className:" w-full max-h-[400px]",children:[(0,r.jsx)(_.xD,{className:"sticky top-0 z-10 bg-white",children:(0,r.jsxs)(_.SC,{children:[(0,r.jsxs)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:["地址（",Object.keys(e).length,"）"]}),(0,r.jsx)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:"sol余额"}),(0,r.jsxs)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:["基础代币",t.symbol]}),(0,r.jsxs)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:["目标代币",n.symbol]}),(0,r.jsx)(_.ss,{className:"w-1/5 text-center text-sm font-normal",children:"操作"})]})}),(0,r.jsx)(_.RM,{children:Object.keys(e).length>0&&Object.values(e).map((e,a)=>{var i,l;return(0,r.jsxs)(_.SC,{className:"",children:[(0,r.jsx)(_.pj,{className:" p-2 pl-4 text-sm text-gray-500",children:(0,T.D2)(e.address)}),(0,r.jsxs)(_.pj,{className:" p-2 text-center",children:[(0,T.az)(e.solBalance,9)," "]}),(0,r.jsx)(_.pj,{className:" p-2 text-center",children:(0,T.az)(null===(i=e.tokens[t.address])||void 0===i?void 0:i.balance,t.decimals)}),(0,r.jsx)(_.pj,{className:" p-2 text-center",children:(0,T.az)(null===(l=e.tokens[n.address])||void 0===l?void 0:l.balance,n.decimals)}),(0,r.jsx)(_.pj,{className:" p-2 text-center",children:(0,r.jsx)(g.z,{variant:"ghost",onClick:()=>{s(e.address)},children:(0,r.jsx)(M.Z,{className:" w-4 text-red-400"})})})]},a)})})]})})})}var eO=a(72735);function eF(){let{swapSetting:e,setSwapSetting:s,nowPrice:a}=E(),{quoteToken:t}=S(),{conn:n,setRpc:i}=k(),[l,o]=(0,u.useState)("0.01"),[c,d]=(0,u.useState)("0.02"),[m,p]=(0,u.useState)("2"),[h,x]=(0,u.useState)("4"),[f,y]=(0,u.useState)("5"),[b,w]=(0,u.useState)("0.01"),[j,N]=(0,u.useState)(""),[T,R]=(0,u.useState)("0.000001"),[P,C]=(0,u.useState)("openbook");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid mt-1 p-1",children:[(0,r.jsxs)("span",{className:"ml-2 text-gray-800",children:["RPC:",(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"（默认rpc是公共的，需要更丝滑的交易请输入您的rpc）"})]}),(0,r.jsx)(B.I,{className:"text-sm text-gray-500 mt-1 w-full",placeholder:"正在使用默认rpc",value:j,onChange:e=>{if(N(e.target.value),e.target.value)try{i(e.target.value)}catch(e){console.log(n.rpcEndpoint),console.log(e)}else i(v.rpc)}})]}),(0,r.jsxs)("div",{className:"mt-2 flex ",children:[(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1  text-gray-800",children:"间隔(秒):"}),(0,r.jsx)(B.I,{value:m,onChange:e=>{p(e.target.value),s({timeMin:Number(e.target.value)})},className:"w-[10%] ml-1",placeholder:"最小（秒）"}),(0,r.jsx)("div",{className:"pt-2 ml-1 mr-1 text-center items-center",children:"~"}),(0,r.jsx)(B.I,{value:h,className:"w-[12%]",onChange:e=>{x(e.target.value),s({timeMax:Number(e.target.value)})},placeholder:"最大（秒）"}),(0,r.jsx)("div",{className:" pt-2 ml-1 mr-1 text-gray-800",children:"滑点(%):"}),(0,r.jsx)(B.I,{value:f,className:"w-[10%]",onChange:e=>{y(e.target.value),s({slippage:Number(e.target.value)})}}),(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1 text-gray-800",children:" 池子类型:"}),(0,r.jsx)(g.z,{onClick:()=>{C("openbook"),s({poolType:"openbook"})},className:"openbook"==P?" bg-green-300":"",variant:"outline",children:"RaydiumV2"}),(0,r.jsx)(g.z,{onClick:()=>{C("cpmm"),s({poolType:"cpmm"})},className:"ml-1"+("cpmm"==P?" bg-green-300":""),variant:"outline",children:"RaydiumV3"})]}),(0,r.jsxs)("div",{className:"mt-2 flex gap-3",children:[(0,r.jsxs)("div",{className:"flex mt-2 ml-2 w-[40%]",children:[(0,r.jsx)("span",{className:" inline-block text-gray-800",children:"金额:"}),(0,r.jsxs)(U.E,{className:"flex ml-4",value:e.amountType,onValueChange:e=>s({amountType:e}),defaultValue:"fixed gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"all",id:"r1"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"全部"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"random",id:"r2"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"随机"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"fixed",id:"r3"}),(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"固定"})]})]})]}),(0,r.jsxs)("div",{className:"h-8 w-[60%]",children:["random"==e.amountType&&(0,r.jsxs)("div",{className:"ml-4 flex gap-3",children:[(0,r.jsx)(B.I,{value:l,onChange:e=>{o(e.target.value),s({amountMin:Number(e.target.value)})}}),(0,r.jsx)("span",{className:"mt-2",children:"~"}),(0,r.jsx)(B.I,{value:c,onChange:e=>{d(e.target.value),s({amountMax:Number(e.target.value)})}})]}),"fixed"==e.amountType&&(0,r.jsx)("div",{className:"ml-4 flex gap-3",children:(0,r.jsx)(B.I,{value:c,onChange:e=>{d(e.target.value),s({amountMax:Number(e.target.value)})}})})]})]}),(0,r.jsxs)("div",{className:"mt-5 flex flex-auto ",children:[(0,r.jsxs)("div",{className:"flex min-w-[29%]",children:[(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1 text-gray-800",children:"模式:"}),(0,r.jsxs)(U.E,{className:"ml-4 flex",onValueChange:e=>s({swapType:e}),defaultValue:"pumping",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"pumping",id:"r1"}),(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"拉盘"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(U.m,{value:"dumping",id:"r2"}),(0,r.jsx)("span",{className:"text-gray-500 text-sm",children:"砸盘"})]})]})]}),(0,r.jsx)("span",{className:" pt-2 ml-5 mr-1 min-w-[10%] text-gray-800",children:"目标价格:"}),(0,r.jsx)(B.I,{value:b,className:" ml-3 w-full",onChange:e=>{w(e.target.value),s({targetPrice:Number(e.target.value)})},placeholder:"输入目标价格"})]}),(0,r.jsxs)("div",{className:"mt-3 grid space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:" pt-2 ml-2 mr-1 text-gray-800",children:"Jito小费:"}),(0,r.jsx)(g.z,{onClick:()=>{R("0.000001"),s({fee:Number("0.000001")})},className:" w-[4rem]"+("0.000001"==T?" bg-green-300":""),variant:"outline",children:"默认"}),(0,r.jsx)(g.z,{onClick:()=>{R("0.00005"),s({fee:Number("0.00005")})},className:"ml-1"+("0.00005"==T?" bg-green-300":""),variant:"outline",children:"快速"}),(0,r.jsx)(g.z,{onClick:()=>{R("0.0001"),s({fee:Number("0.0001")})},className:"ml-1"+("0.0001"==T?" bg-green-300":""),variant:"outline",children:"超快速"}),(0,r.jsxs)("div",{className:"ml-5 flex w-[57%] relative",children:[(0,r.jsx)(B.I,{value:T,onChange:e=>{R(e.target.value),s({fee:Number(e.target.value)})},className:"ml-2 w-full"}),(0,r.jsx)(g.z,{className:"right-0 absolute",disabled:!0,variant:"ghost",children:"Sol"})]})]}),(0,r.jsx)("div",{className:"flex "}),(0,r.jsxs)("div",{className:"mt-1 text-red-400 text-center text-lg ",children:["当前价格: $",a.toFixed(18)]})]})]})}function ez(){let{wallets:e,setSolBalance:s,setTokenBalance:a,addToken:t}=c(),{conn:n}=k(),[i,l]=(0,u.useState)(!1),o=async()=>{for(let r of(l(!0),Object.values(e))){let e=await n.getBalance(r.keypair.publicKey,"confirmed");s(r.address,e),a(r.address,"So11111111111111111111111111111111111111112",e);try{let e=await fetch(v.heliseRpc,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"1",method:"getTokenAccounts",params:{owner:r.address,page:1,limit:100,displayOptions:{showZeroBalance:!1}}})}),{result:s}=await e.json();for(let e of s.token_accounts){let s={account:e.address,balance:e.amount,address:e.mint,mint:e.mint,name:"",decimals:0,symbol:"",logoURI:""};t(r.address,e.mint,s)}}catch(e){console.log(e)}await (0,T._v)(200),l(!1)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g.z,{variant:"outline",loading:i,onClick:o,children:"刷新余额"})})}var eU=a(42323);async function eW(e){var s;let{mint1:a,mint2:t,connection:n,poolType:r="openbook"}=e,i=await eU.kk0.load({connection:n}),l=await i.api.fetchPoolByMints({mint1:a,mint2:t});if((null===(s=l.data)||void 0===s?void 0:s.length)==0)throw Error("找不到代币对对应的池子，检查池子是否存在（该工具目前只支持raydium OpenBook池子和 raydium CPMM池子）");if("openbook"==r){for(let e=0;e<l.data.length;e++){let s=l.data[e];if(s.programId===eU.K2x.toBase58())return s}throw Error("没有找到raydiumV2的池子")}for(let e=0;e<l.data.length;e++){let s=l.data[e];if("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"===s.programId)return s}throw Error("没有找到raydiumV3的池子")}async function eV(e,s,a,t,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.05,i=await eU.kk0.load({connection:n});if(e.programId===eU.K2x.toBase58()){let n=(await i.api.fetchPoolById({ids:e.id}))[0];await i.liquidity.getAmmPoolKeys(e.id);let l=await i.liquidity.getRpcPoolInfo(e.id),[o,c,d]=[l.baseReserve,l.quoteReserve,l.status.toNumber()];if(n.mintA.address!==a&&n.mintB.address!==a)throw Error("input mint does not match pool");return await i.liquidity.initLayout(),i.liquidity.computeAmountOut({poolInfo:{...n,baseReserve:o,quoteReserve:c,status:d,version:4},amountIn:new(em())(s),mintIn:a,mintOut:t,slippage:r}).amountOut.toString()}if("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"===e.programId){let t=(await i.api.fetchPoolById({ids:e.id}))[0],n=await i.cpmm.getRpcPoolInfo(t.id,!0),r=new(em())(s);return(t.mintA.address===a?eU.mir.swap(r,n.baseReserve,n.quoteReserve,n.configInfo.tradeFeeRate):eU.mir.swap(r,n.quoteReserve,n.baseReserve,n.configInfo.tradeFeeRate)).destinationAmountSwapped.toString()}throw Error("不支持的池子类型")}let eq=async e=>{let{connection:s,owner:a,amountIn:t,mintIn:n,mintOut:r,poolId:i,microLamports:l=0,slippage:o=.005,txVersion:c=eU.eVA.LEGACY}=e,d=await eU.kk0.load({owner:a,connection:s,cluster:"mainnet",disableFeatureCheck:!0}),u=(await d.api.fetchPoolById({ids:i}))[0],g=await d.liquidity.getAmmPoolKeys(i);(await (0,eU.WCb)({connection:d.connection,poolKeysList:[g],config:void 0}))[0];let p=await d.liquidity.getRpcPoolInfo(i),[h,f,y]=[p.baseReserve,p.quoteReserve,p.status.toNumber()];await d.liquidity.initLayout();let b=d.liquidity.computeAmountOut({poolInfo:{...u,baseReserve:h,quoteReserve:f,status:y,version:4},amountIn:new(em())(t),mintIn:n,mintOut:r,slippage:o}),{transaction:w}=await d.liquidity.swap({poolInfo:u,amountIn:new(em())(t),amountOut:b.amountOut,fixedSide:"in",inputMint:n,txVersion:c,computeBudgetConfig:void 0});w.add(m.SystemProgram.transfer({fromPubkey:a.publicKey,toPubkey:new m.PublicKey(v.jitoTipAccount),lamports:m.LAMPORTS_PER_SOL*l})),console.log(m.LAMPORTS_PER_SOL*l),v.useRaydiumFee>0&&w.add(m.SystemProgram.transfer({fromPubkey:a.publicKey,toPubkey:new m.PublicKey(v.FEE_WALLET),lamports:m.LAMPORTS_PER_SOL*Number(v.useRaydiumFee)}));let j=await s.getLatestBlockhash("confirmed");w.recentBlockhash=j.blockhash,w.feePayer=a.publicKey,w.sign(a);let k=x.encode(w.signature);if(!await es("",w))throw Error("无法发送交易，请检查网络连接");if(!await ee(k,s,j.lastValidBlockHeight))throw Error("交易等待过期，跳过本钱包，您可以增加jito小费来保持较高的成功率");return console.log("Sell transaction confirmed:",k),k},eD=async e=>{let s,a,{connection:t,owner:n,amountIn:r,mintIn:i,mintOut:l,poolId:o,microLamports:c=0}=e,d=await eU.kk0.load({owner:n,connection:t,cluster:"mainnet",disableFeatureCheck:!0}),u=(await d.api.fetchPoolById({ids:o}))[0],g=await d.cpmm.getRpcPoolInfo(u.id,!0),p=new(em())(r);console.log(i),u.mintA.address===i?(s=!0,a=eU.mir.swap(p,g.baseReserve,g.quoteReserve,g.configInfo.tradeFeeRate)):(console.log(l),s=!1,a=eU.mir.swap(p,g.quoteReserve,g.baseReserve,g.configInfo.tradeFeeRate));let{transaction:h}=await d.cpmm.swap({poolInfo:u,swapResult:a,baseIn:s,computeBudgetConfig:void 0});h.add(m.SystemProgram.transfer({fromPubkey:n.publicKey,toPubkey:new m.PublicKey(v.jitoTipAccount),lamports:m.LAMPORTS_PER_SOL*c})),v.useRaydiumFee>0&&h.add(m.SystemProgram.transfer({fromPubkey:n.publicKey,toPubkey:new m.PublicKey(v.FEE_WALLET),lamports:m.LAMPORTS_PER_SOL*Number(v.useRaydiumFee)}));let f=await t.getLatestBlockhash("confirmed");h.recentBlockhash=f.blockhash,h.feePayer=n.publicKey,h.sign(n);let y=x.encode(h.signature);if(!await es("",h))throw Error("无法发送交易，请检查网络连接");if(!await ee(y,t,f.lastValidBlockHeight))throw Error("交易等待过期，跳过本钱包，您可以增加jito小费来保持较高的成功率");return console.log("Sell transaction confirmed:",y),y};function eZ(){let{wallets:e,setSolBalance:s,setTokenBalance:a,addToken:t}=c(),{conn:n}=k(),{swapSetting:i,taskCount:l,incrementTaskCount:o,clearTaskCount:d,nowPrice:p,setNowPrice:h}=E(),[x,f]=(0,u.useState)(!1),[y,b]=(0,u.useState)(170),[w,j]=(0,u.useState)(),[N,T]=(0,u.useState)(!1),{addLog:P,clearLog:B}=R(),{baseToken:C,quoteToken:I}=S(),K=(e,s)=>(e>s&&([e,s]=[s,e]),e===s)?e:e<=0||s<=0?0:s-e<1?e+Math.random()*(s-e):Math.floor(Math.random()*(s-e+1)+e),A=async()=>{if(!w){f(!1),P("error","请先查池子");return}let e=1e6;"So11111111111111111111111111111111111111112"===C.address&&(e=Math.floor(1/y*m.LAMPORTS_PER_SOL),console.log("SolPrice: ",y),console.log("amountIn: ",e));let s=await eV(w,e,C.address,I.address,n,.05);console.log(Number(s)/10**I.decimals),h(1/(Number(s)/10**I.decimals))},_=async()=>{T(!0),await O();try{let e=await eW({connection:n,mint1:C.address,mint2:I.address,poolType:i.poolType}),s=1e6;"So11111111111111111111111111111111111111112"===C.address&&(s=Math.floor(1/y*m.LAMPORTS_PER_SOL),console.log("SolPrice: ",y),console.log("amountIn: ",s));let a=await eV(e,s,C.address,I.address,n,.05);console.log(Number(a)/10**I.decimals);let t=Number(a)/10**I.decimals;j(e),h(1/t),P("info","查池子成功 池子地址:"+e.id)}catch(e){P("error",e.message)}T(!1)},L=s=>{if("fixed"==i.amountType)return i.amountMax*10**C.decimals;if("random"==i.amountType)return K(i.amountMin,i.amountMax)*10**C.decimals;if("all"==i.amountType){var a,t;let n=null!==(t=null===(a=e[s].tokens[C.address])||void 0===a?void 0:a.balance)&&void 0!==t?t:0;if("So11111111111111111111111111111111111111112"==C.address)return(n=n-i.fee*m.LAMPORTS_PER_SOL-v.useRaydiumFee*m.LAMPORTS_PER_SOL-5e3)<0&&(n=0),n}return 0},M=s=>{if("fixed"==i.amountType)return i.amountMax*10**I.decimals;if("random"==i.amountType)return K(i.amountMin,i.amountMax)*10**I.decimals;if("all"==i.amountType){var a,t;return null!==(t=null===(a=e[s].tokens[I.address])||void 0===a?void 0:a.balance)&&void 0!==t?t:0}return 0},O=async()=>{try{let e=await fetch("https://price.jup.ag/v4/price?ids=So11111111111111111111111111111111111111112"),s=await e.json();b(s.data.So11111111111111111111111111111111111111112.price)}catch(e){console.error("There was a problem with the fetch operation:",e),P("error","获取SOL价格失败 请检查网络"+e.message)}},U=async e=>{let r=await n.getBalance(e.keypair.publicKey);if(s(e.address,r),"So11111111111111111111111111111111111111112"===C.address)a(e.address,C.address,Number(r));else if(e.tokens[C.address]&&""!=e.tokens[C.address].account){let s=await n.getTokenAccountBalance(new m.PublicKey(e.tokens[C.address].account));a(e.address,C.address,Number(s.value.amount))}else(await (0,J.tQ)(n,e.keypair.publicKey)).map(s=>{if(s.accountInfo.mint.toBase58()==C.address){console.log("account",s.accountInfo.mint.toBase58()),console.log("amount",s.accountInfo.amount.toString());let a={account:s.pubkey.toBase58(),balance:Number(s.accountInfo.amount.toString()),address:s.accountInfo.mint.toBase58(),mint:s.accountInfo.mint.toBase58(),name:"",decimals:C.decimals,symbol:"",logoURI:""};t(e.address,s.accountInfo.mint.toBase58(),a)}else a(e.address,C.address,Number(0))});if("So11111111111111111111111111111111111111112"===I.address)a(e.address,I.address,Number(r));else if(e.tokens[I.address]&&""!=e.tokens[I.address].account){let s=await n.getTokenAccountBalance(new m.PublicKey(e.tokens[I.address].account));a(e.address,I.address,Number(s.value.amount))}else(await (0,J.tQ)(n,e.keypair.publicKey)).map(s=>{if(s.accountInfo.mint.toBase58()==I.address){console.log("account",s.accountInfo.mint.toBase58()),console.log("amount",s.accountInfo.amount.toString());let a={account:s.pubkey.toBase58(),balance:Number(s.accountInfo.amount.toString()),address:s.accountInfo.mint.toBase58(),mint:s.accountInfo.mint.toBase58(),name:"",decimals:I.decimals,symbol:"",logoURI:""};t(e.address,s.accountInfo.mint.toBase58(),a)}})};return(0,Z.Z)(async()=>{let s,a;if(i.fee<1e-6){P("error","市值机器人使用jito提交打包，手续费至少0.000001 SOL"),f(!1);return}if(await O(),0===Object.keys(e).length){P("error","请添加钱包"),f(!1);return}if(l>=Object.keys(e).length){d();return}P("info","开始执行",Object.values(e)[l].address);let t=Object.values(e)[l];try{await U(t),await A(),console.log("nowPrice: ",p),P("info","当前价格:"+"".concat(p.toFixed(18)))}catch(e){P("error","329更新余额失败 "+e.message),f(!1);return}let r=0;if("pumping"===i.swapType){if(0==t.tokens[C.address].balance){P("info","余额0，跳过该钱包"),o();return}if(i.targetPrice<=p){P("success","达到目标价格程序结束"),d(),f(!1);return}if(P("info","拉盘开始"),(r=L(t.address))>t.tokens[C.address].balance){P("info","余额不足，跳过该钱包"),o();return}if(0===r){P("error","358 输入价格为0，跳过该钱包"),o();return}s=new eO.WUB(eO.H__,new m.PublicKey(C.address),C.decimals,C.symbol),a=new eO.WUB(eO.H__,new m.PublicKey(I.address),I.decimals,I.symbol)}else{var c,u;if(!t.tokens[I.address]||(null===(c=t.tokens[I.address])||void 0===c?void 0:c.balance)==0){P("info","余额0，跳过该钱包"),o();return}if(i.targetPrice>=p){P("success","达到目标价格程序结束"),d(),f(!1);return}if(P("info","砸盘开始"),(r=M(t.address))>(null===(u=t.tokens[I.address])||void 0===u?void 0:u.balance)){P("info","余额不足，跳过该钱包"),o();return}if(0===r){P("error","交易数量为0，跳过该钱包。",t.address),o();return}a=new eO.WUB(eO.H__,new m.PublicKey(C.address),C.decimals,C.symbol),s=new eO.WUB(eO.H__,new m.PublicKey(I.address),I.decimals,I.symbol)}console.log(r=Math.floor(r)),console.log(i.poolType);try{let e="";e="openbook"===i.poolType?await eq({connection:n,owner:t.keypair,mintIn:s.mint.toBase58(),mintOut:a.mint.toBase58(),amountIn:r,poolId:w.id,slippage:i.slippage/100,microLamports:i.fee}):await eD({connection:n,owner:t.keypair,mintIn:s.mint.toBase58(),mintOut:a.mint.toBase58(),amountIn:r,poolId:w.id,microLamports:i.fee}),P("success","执行成功",t.address,e)}catch(e){e instanceof m.TransactionExpiredTimeoutError?P("info","交易等待超时，交易可能成功了，请查看哈希:"+"".concat(e.message),t.address,e.signature):e instanceof m.TransactionExpiredBlockheightExceededError?P("info","交易等待区块高度超时，交易可能成功了，请查看哈希:"+"".concat(e.message),t.address,e.signature):e.message.includes("Transaction simulation failed")?P("error","执行失败，可能是价格变动太大，请调整滑点，跳过该钱包。"+"错误消息：".concat(e.message),t.address):e.message.includes('failed ({"err":{"InstructionError":[4,{"Custom":30}]}}')?P("error","执行失败，可能是价格变动太大，请调整滑点，跳过该钱包。"+"错误消息：".concat(e.message),t.address,e.signature):e.message.includes("amounts must greater than zero")?P("error","执行失败，金额太小，请加大金额，跳过该钱包。"+"错误消息：".concat(e.message),t.address,e.signature):P("error","执行失败 跳过该钱包。"+"".concat(e.message),t.address,e.signature)}let g=K(1e3*i.timeMin,1e3*i.timeMax);P("info","".concat(g/1e3,"秒后")+"执行下一个钱包"),await new Promise(e=>setTimeout(e,g)),o()},x?200:null),(0,r.jsxs)("div",{className:"grid p-3 mt-2 w-[750px]",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsx)(e_,{}),(0,r.jsx)(ez,{}),(0,r.jsx)(g.z,{onClick:()=>{window.open("https://help.pandatool.org/sol/swapbot")},variant:"outline",children:"查看教程"})]}),(0,r.jsx)(eM,{}),(0,r.jsx)(eL,{}),(0,r.jsx)(eF,{}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-4 mt-2",children:[(0,r.jsx)(g.z,{variant:"outline",loading:N,onClick:_,children:"查池子"}),(0,r.jsxs)(g.z,{onClick:()=>{d(),f(!0)},loading:x,variant:"outline",className:"bg-green-400 hover:bg-green-500 hover:text-gray-100 text-white",children:["开始 ",(0,r.jsx)(z.Z,{className:"w-5 h-5 ml-1"})]}),(0,r.jsxs)(g.z,{onClick:()=>{f(!1)},disabled:!x,variant:"outline",className:"bg-red-400 hover:bg-red-500 text-white hover:text-gray-100",children:["停止 ",(0,r.jsx)(F.Z,{className:"w-5 h-5 ml-1"})]}),(0,r.jsx)(g.z,{variant:"outline",onClick:B,children:"清空日志"})]}),(0,r.jsx)(D,{}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("h4",{className:"text-gray-500 text-sm ",children:[" ","每笔交易收费",v.useRaydiumFee," SOL"]})})]})}function eJ(){let{swapType:e,setSwapType:s}=L(),{swapSetting:a}=E(),{wallets:t}=c();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{className:"bg-gradient-to-tr mb-3  from-[#5b5464] to-[#62776f] bg-clip-text text-center text-5xl font-bold text-transparent",children:"市值管理"}),(0,r.jsxs)(i.mQ,{defaultValue:e,children:[(0,r.jsxs)(i.dr,{className:"grid grid-cols-2 mx-3 bg-slate-100",children:[(0,r.jsx)(i.SP,{className:" flex  items-center ",value:"Raydium",onClick:()=>{s("Raydium")},children:"Raydium市值管理"}),(0,r.jsx)(i.SP,{className:" flex  items-center",value:"Pump",onClick:()=>{s("Raydium")},children:"Pump市值管理"})]}),(0,r.jsx)(i.nU,{value:"Raydium",className:"w-full",children:(0,r.jsx)(eZ,{})}),(0,r.jsx)(i.nU,{value:"Pump",children:(0,r.jsx)(eA,{})})]})]})}},40110:function(e,s,a){"use strict";a.d(s,{SP:function(){return c},dr:function(){return o},mQ:function(){return l},nU:function(){return d}});var t=a(57437),n=a(2265),r=a(46457),i=a(1657);let l=r.fC,o=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...n})});o.displayName=r.aV.displayName;let c=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-green-200 data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...n})});c.displayName=r.xz.displayName;let d=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...n})});d.displayName=r.VY.displayName}},function(e){e.O(0,[814,125,866,701,335,535,99,955,654,797,1,997,971,69,744],function(){return e(e.s=43053)}),_N_E=e.O()}]);
